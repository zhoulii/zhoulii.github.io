<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Flink ä½¿ç”¨ FTP ä½œä¸º Checkpoint æ–‡ä»¶ç³»ç»Ÿ</title>
    <url>/2020/06/29/flink/Flink%20%E4%BD%BF%E7%94%A8%20FTP%20%E4%BD%9C%E4%B8%BA%20Checkpoint%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/</url>
    <content><![CDATA[<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/panda-banner-1.png"></p>
<span id="more"></span>

<h2 id="01-èƒŒæ™¯è¯´æ˜"><a href="#01-èƒŒæ™¯è¯´æ˜" class="headerlink" title="01.èƒŒæ™¯è¯´æ˜"></a>01.èƒŒæ™¯è¯´æ˜</h2><p><code>Flink Job</code> åœ¨è¿è¡Œå¤±è´¥æ—¶ï¼Œå¯ä»¥ä»ä¸Šä¸€ä¸ª <code>checkpoint</code> è¿›è¡Œæ¢å¤ï¼Œä¸è¿‡è¿™æœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯ <code>checkpoint</code> æ•°æ®å¯¹æ‰€æœ‰çš„ <code>Task</code> æ¥è¯´éƒ½æ˜¯å¯ä»¥è®¿é—®çš„ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šå°† <code>checkpoint</code> ç›®å½•è®¾ç½®ä¸º <code>HDFS</code>ï¼Œä½†åœ¨ä¸€äº›è½»é‡çº§çš„ç”Ÿäº§åœºæ™¯ä¸­æ˜¯æ²¡æœ‰éƒ¨ç½² <code>HDFS</code> çš„ï¼Œæ‰€ä»¥è€ƒè™‘ä½¿ç”¨ <code>FTP</code> æ¥ä¿å­˜ <code>checkpoint</code> æ•°æ®ã€‚</p>
<h2 id="02-å®ç°æ€è·¯"><a href="#02-å®ç°æ€è·¯" class="headerlink" title="02.å®ç°æ€è·¯"></a>02.å®ç°æ€è·¯</h2><p><code>Flink</code> å¯ä»¥ä½¿ç”¨ <code>HDFS</code> ä½œä¸º <code>checkpoint</code> ç›®å½•çš„åŸå› æ˜¯ <code>Flink</code> æ”¯æŒ <code>HDFS</code> æ–‡ä»¶ç³»ç»Ÿï¼Œæ‰€ä»¥å¦‚æœ <code>Flink</code> å¯ä»¥æ”¯æŒ <code>FTP</code> æ–‡ä»¶ç³»ç»Ÿï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ <code>FTP</code> æ¥å­˜å‚¨ <code>checkpoint</code> æ•°æ®ã€‚æŸ¥çœ‹ <code>hadoop</code> çš„ <code>hadoop-common</code> æ¨¡å—ï¼Œå¯ä»¥å‘ç° <code>FTP</code> å¯¹åº”çš„æ–‡ä»¶ç³»ç»Ÿå®ç°æ˜¯ <code>FTPFileSystem</code>ï¼Œè€Œ <code>Flink</code> æ–‡ä»¶ç³»ç»Ÿåˆæ˜¯å…¼å®¹ <code>Hadoop</code> æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæ‰€ä»¥åªè¦å¼•å…¥ <code>hadoop-common</code> æ¨¡å—ä¾¿å¯ä»¥è®© <code>Flink</code> æ”¯æŒ <code>FTP</code>ï¼Œä¸è¿‡ï¼Œä¸ºé˜²æ­¢ç±»å†²çªï¼Œæœ€å¥½å¼•å…¥ <code>Flink</code> æä¾›çš„ <code>flink-shaded-hadoop</code>ã€‚</p>
<h2 id="03-å®ç°æ­¥éª¤"><a href="#03-å®ç°æ­¥éª¤" class="headerlink" title="03.å®ç°æ­¥éª¤"></a>03.å®ç°æ­¥éª¤</h2><ul>
<li>å°† <code>flink-shaded-hadoop-2-uber-xxx.jar</code> æ”¾åˆ° <code>Flink</code> çš„ <code>lib</code> è·¯å¾„ä¸‹ï¼ˆå¿…é¡»æ”¾åˆ° <code>lib</code> è·¯å¾„ä¸‹ï¼Œæ‰“åœ¨ä½œä¸š <code>Jar</code> ä¸­åŠ è½½ä¸åˆ°ï¼‰ï¼›</li>
<li>é‡å¯ <code>Flink Standalone</code> é›†ç¾¤;</li>
<li>ä½œä¸šä»£ç ä¸­å°† checkpoint ç›®å½•è®¾ç½®ä¸º ftpï¼Œè®¾ç½®æ–¹å¼å¦‚ä¸‹ï¼š<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">env.setStateBackend(<span class="keyword">new</span>Â <span class="title class_">RocksDBStateBackend</span>(<span class="string">&quot;ftp://user:password@ip:port/path&quot;</span>).asInstanceOf[StateBackend])</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="04-é—®é¢˜åˆ†æ"><a href="#04-é—®é¢˜åˆ†æ" class="headerlink" title="04.é—®é¢˜åˆ†æ"></a>04.é—®é¢˜åˆ†æ</h2><p>æäº¤ä½œä¸šåˆ°é›†ç¾¤ï¼Œå¯ä»¥å‘ç° <code>Job</code> æ˜¯æ­£å¸¸è¿è¡Œçš„ï¼Œä¸è¿‡æŸ¥çœ‹ <code>JobManager</code> çš„æ—¥å¿—å¯ä»¥å‘ç°ï¼Œcheckpoint å‡ºé”™äº†ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/ftp-checkpoint-error.png"></p>
<p>è¿™é‡Œç»™å‡ºçš„é”™è¯¯åŸå› æ˜¯æ— æ³•åˆ›å»º <code>checkpoint</code> ç›®å½•ï¼Œè€Œæ­¤æ—¶ <code>FTP</code> æœåŠ¡æ˜¯æ­£å¸¸çš„ï¼Œæ‰‹åŠ¨åˆ›å»ºç›®å½•ã€ä¸Šä¼ æ–‡ä»¶éƒ½æ²¡é—®é¢˜ï¼Œæ‰€ä»¥å¯ä»¥æ’é™¤ <code>FTP</code> æœ¬èº«çš„é—®é¢˜ã€‚ç»è¿‡ä»£ç è°ƒè¯•å‘ç°ï¼Œé—®é¢˜æ˜¯ç”±è·¯å¾„å¼•èµ·çš„ï¼Œå› ä¸ºä½¿ç”¨ <code>FTPFileSystem</code> åˆ›å»ºç›®å½•æ—¶ï¼Œè·¯å¾„å¿…é¡»æ˜¯ <code>/A/B/C</code> è¿™æ ·çš„å½¢å¼ï¼Œåƒ <code>ftp://user:password@ip:port/path</code> è¿™æ ·çš„è·¯å¾„æ˜¯ä¸è¢« <code>FTPFileSystem</code> æ”¯æŒçš„ã€‚</p>
<h2 id="05-è‡ªå®šä¹‰-FTPFileSystem"><a href="#05-è‡ªå®šä¹‰-FTPFileSystem" class="headerlink" title="05.è‡ªå®šä¹‰ FTPFileSystem"></a>05.è‡ªå®šä¹‰ FTPFileSystem</h2><p>è‡ªå®šä¹‰<code>FTPFileSystem</code> æ¥æ”¯æŒ <code>ftp://user:password@ip:port/path</code>  æ ¼å¼çš„è·¯å¾„ï¼Œå®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p><strong>1.åˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®ï¼Œpom å†™æ³•å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä¾èµ– --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flink<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flink-shaded-hadoop-2-uber<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.5-10.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ‰“åŒ…æ’ä»¶ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-shade-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">goal</span>&gt;</span>shade<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">artifactSet</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">exclude</span>&gt;</span>com.google.code.findbugs:jsr305<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">exclude</span>&gt;</span>org.slf4j:*<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">exclude</span>&gt;</span>log4j:*<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">artifactSet</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">filters</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">							<span class="comment">&lt;!-- Do not copy the signatures in the META-INF folder.</span></span><br><span class="line"><span class="comment">							Otherwise, this might cause SecurityExceptions when using the JAR. --&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">artifact</span>&gt;</span>*:*<span class="tag">&lt;/<span class="name">artifact</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">excludes</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">exclude</span>&gt;</span>META-INF/*.SF<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">exclude</span>&gt;</span>META-INF/*.DSA<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">								<span class="tag">&lt;<span class="name">exclude</span>&gt;</span>META-INF/*.RSA<span class="tag">&lt;/<span class="name">exclude</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">excludes</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">filters</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>2.å¤åˆ¶ <code>FTPFileSystem</code> åˆ°é¡¹ç›®ä¸­ï¼Œå¹¶å°†å…¶é‡å‘½åä¸º <code>HFTPFileSystem</code></strong></p>
<p><strong>3.ä¿®æ”¹ <code>HFTPFileSystem</code> ä¸­çš„ <code>makeabsolute</code> æ–¹æ³•ï¼Œä¿®æ”¹åçš„æ–¹æ³•å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> Path <span class="title function_">makeAbsolute</span><span class="params">(Path workDir, Path path)</span> &#123;</span><br><span class="line">	Path absolute;</span><br><span class="line">	<span class="keyword">if</span>(<span class="string">&quot;hftp&quot;</span>.equals(path.toUri().getScheme()))&#123;</span><br><span class="line">		<span class="keyword">final</span> <span class="type">String</span> <span class="variable">pathStr</span> <span class="operator">=</span> path.toUri().getPath().substring(<span class="number">1</span>);</span><br><span class="line">		absolute = <span class="keyword">new</span> <span class="title class_">Path</span>(workDir, pathStr);</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (path.isAbsolute()) &#123;</span><br><span class="line">			<span class="keyword">return</span> path;</span><br><span class="line">		&#125;</span><br><span class="line">		absolute = <span class="keyword">new</span> <span class="title class_">Path</span>(workDir, path);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> absolute;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>4.ä¿®æ”¹ <code>HFTPFileSystem</code> ä¸­çš„ <code>getSchema</code> æ–¹æ³•ï¼Œä¿®æ”¹åçš„æ–¹æ³•å¦‚ä¸‹ï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span>Â StringÂ <span class="title function_">getScheme</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span>Â <span class="string">&quot;hftp&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>5.åœ¨ <code>resources/META-INF/services</code> ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªåä¸º <code>org.apache.hadoop.fs.FileSystem</code> çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸º <code>HFTPFileSystem</code> çš„å…¨è·¯å¾„å</strong></p>
<p><strong>6.å°†é¡¹ç›®æ‰“æˆ <code>jar</code> åŒ…</strong></p>
<h2 id="06-è‡ªå®šä¹‰-FTPFileSystem-çš„ä½¿ç”¨"><a href="#06-è‡ªå®šä¹‰-FTPFileSystem-çš„ä½¿ç”¨" class="headerlink" title="06.è‡ªå®šä¹‰ FTPFileSystem çš„ä½¿ç”¨"></a>06.è‡ªå®šä¹‰ FTPFileSystem çš„ä½¿ç”¨</h2><ul>
<li>å°†å¼€å‘å¥½çš„é¡¹ç›® <code>jar</code> åŒ…æ”¾åˆ° <code>Flink</code> çš„ <code>lib</code> è·¯å¾„ä¸‹ï¼ˆå¿…é¡»æ”¾åˆ° <code>lib</code> è·¯å¾„ä¸‹ï¼Œæ‰“åœ¨ä½œä¸š <code>jar</code> ä¸­åŠ è½½ä¸åˆ°ï¼‰ï¼›</li>
<li>é‡å¯ <code>Flink Standalone</code> é›†ç¾¤ï¼›</li>
<li>ä½œä¸šä»£ç ä¸­å°† <code>checkpoint</code> ç›®å½•è®¾ç½®ä¸º <code>ftp</code>ï¼Œåè®®å¤´ä½¿ç”¨ <code>hftp</code>ï¼Œè®¾ç½®æ–¹å¼å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">env.setStateBackend(<span class="keyword">new</span>Â <span class="title class_">RocksDBStateBackend</span>(<span class="string">&quot;hftp://user:password@ip:port/path&quot;</span>).asInstanceOf[StateBackend])</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œæäº¤ä½œä¸šåˆ°é›†ç¾¤ï¼Œå¯ä»¥å‘ç° <code>Job</code> æ˜¯æ­£å¸¸è¿è¡Œçš„ï¼Œ<code>checkpoint</code> æ•°æ®ä¹Ÿé¡ºåˆ©è½åœ°åˆ°æ‰€é…ç½®çš„ <code>FTP</code> ç›®å½•ã€‚</p>
<h2 id="07-å‚è€ƒèµ„æ–™"><a href="#07-å‚è€ƒèµ„æ–™" class="headerlink" title="07.å‚è€ƒèµ„æ–™"></a>07.å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="https://blog.csdn.net/weixin_41917987/article/details/90294765">Flinkçš„standaloneè¿è¡Œæ¨¡å¼ä¹‹Stateå­˜å‚¨â€”-ä¸ä½¿ç”¨HDFS</a></li>
</ul>
]]></content>
      <categories>
        <category>Flink</category>
      </categories>
      <tags>
        <tag>Flink</tag>
      </tags>
  </entry>
  <entry>
    <title>Flink ä½¿ç”¨ FTP ä½œä¸º Checkpoint æ–‡ä»¶ç³»ç»Ÿå­˜åœ¨çš„é—®é¢˜</title>
    <url>/2020/07/05/flink/Flink%20%E4%BD%BF%E7%94%A8%20FTP%20%E4%BD%9C%E4%B8%BA%20Checkpoint%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/panda-banner-1.png"></p>
<span id="more"></span>

<h2 id="01-èƒŒæ™¯è¯´æ˜"><a href="#01-èƒŒæ™¯è¯´æ˜" class="headerlink" title="01.èƒŒæ™¯è¯´æ˜"></a>01.èƒŒæ™¯è¯´æ˜</h2><a href="/2020/06/29/flink/Flink%20%E4%BD%BF%E7%94%A8%20FTP%20%E4%BD%9C%E4%B8%BA%20Checkpoint%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" title="Flink ä½¿ç”¨ FTP ä½œä¸º Checkpoint æ–‡ä»¶ç³»ç»Ÿ">Flink ä½¿ç”¨ FTP ä½œä¸º Checkpoint æ–‡ä»¶ç³»ç»Ÿ</a> ä»‹ç»äº†å¦‚ä½•è®© Flink Checkpoint åç«¯æ”¯æŒ FTPï¼Œå¹¶å®ç°äº†æ­¤é¡¹åŠŸèƒ½ã€‚é¡¹ç›®ä¸Šçº¿åï¼ŒFTP ä½œä¸º Flink Checkpoint çŠ¶æ€åç«¯å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†é¡¹ç›®è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œå¶å°”åœ¨åš Checkpoint æ—¶ä¼šå‡ºç°ç«¯å£è¢«å ç”¨å¼‚å¸¸ï¼Œä»è€Œå‡ºç° Checkpoint å¤±è´¥ï¼Œä½œä¸šé‡å¯çš„é—®é¢˜ã€‚

<h2 id="02-é—®é¢˜æ’æŸ¥"><a href="#02-é—®é¢˜æ’æŸ¥" class="headerlink" title="02.é—®é¢˜æ’æŸ¥"></a>02.é—®é¢˜æ’æŸ¥</h2><p>é¦–å…ˆçœ‹ä¸‹å¼‚å¸¸å‘ç”Ÿçš„ä½ç½®ï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/flink-ftp-checkpoint-failed.png"></p>
<p>ä¸‹é¢æ˜¯æˆ‘çš„æ’æŸ¥æ€è·¯ï¼š</p>
<ul>
<li>æ£€æŸ¥æœºå™¨çš„ç«¯å£ï¼Œå‘ç°å¤§é‡ç«¯å£å¤„äº time_wait çŠ¶æ€ï¼Œæ¨æµ‹çŸ­é“¾æ¥å»ºç«‹å¤ªå¤šï¼Œæœºå™¨ç«¯å£è¢«å ç”¨å®Œï¼›</li>
<li>æ’æŸ¥ä»£ç ï¼Œ<code>_serverSocketFactory_.createServerSocket</code> ç»‘å®šçš„ç«¯å£æ˜¯ 0ï¼Œæ„æ€æ˜¯ç”±æ“ä½œç³»ç»Ÿåˆ†é…å¯ç”¨ç«¯å£ï¼Œæ— ç«¯å£å¯åˆ†é…ä¹Ÿä¼šæŠ›å‡ºç«¯å£è¢«å ç”¨å¼‚å¸¸ï¼Œè¿›ä¸€æ­¥éªŒè¯ä¸Šé¢çŒœæµ‹ï¼›</li>
</ul>
<p>åˆ†æå‡ºæœºå™¨ç«¯å£è¢«å ç”¨å®Œï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰¾å‡º FTPClient ä¸­ä¸ºä»€ä¹ˆä¼šæœ‰å¤§é‡ç«¯å£æ²¡è¢«é‡Šæ”¾çš„é—®é¢˜äº†ã€‚è¿˜æ˜¯å›åˆ° <code>_openDataConnection_</code> æ–¹æ³•ï¼Œåœ¨ FTPClient ä¸ FTP è¿›è¡Œæ•°æ®äº¤äº’æ—¶ï¼Œæ¯ä¸ªæ•°æ®äº¤äº’æ“ä½œéƒ½éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªä¸æœåŠ¡ç«¯è¿›è¡Œæ•°æ®ä¼ è¾“çš„ Socketï¼ŒçŒœæƒ³å¦‚æœè¿™äº› Socket æ²¡è¢«å…³é—­ï¼Œé‚£ä¹ˆå°±ä¼šä¸æ–­æœ‰ç«¯å£è¢«å ç”¨ã€‚è€Œè·Ÿè¸ªä»£ç å¯ä»¥å‘ç°ï¼ŒFTPClient åœ¨ç”¨å®Œè¿™äº› Socket åï¼Œéƒ½åŠæ—¶è°ƒç”¨äº†å…¶ close æ–¹æ³•å»å…³é—­è¿æ¥ï¼Œæ‰€ä»¥ä¸Šé¢çš„çŒœæƒ³åˆè¿›å…¥äº†æ­»èƒ¡åŒã€‚</p>
<p>åœ¨ç½‘ä¸ŠæŸ¥é˜…ç›¸å…³èµ„æ–™ï¼Œå‘ç°äº†ä¸‹é¢ä¸€æ®µæè¿°ï¼š<code>socket.close()</code> æ“ä½œå¹¶ä¸èƒ½ç«‹å³é‡Šæ”¾ç»‘å®šçš„ç«¯å£ï¼Œè€Œæ˜¯æŠŠç«¯å£è®¾ç½®ä¸º TIME_WAIT çŠ¶æ€ï¼Œè¿‡æ®µæ—¶é—´(é»˜è®¤240s)æ‰é‡Šæ”¾(ç”¨ <code>netstat -na</code> å¯ä»¥çœ‹åˆ°)ï¼Œå¦‚æœå»ºç«‹çŸ­è¿æ¥çš„æ“ä½œè¾ƒä¸ºé¢‘ç¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿç«¯å£èµ„æºè€—å°½ã€‚æ‰€ä»¥ï¼Œæœ€ç»ˆç¡®å®šé—®é¢˜è¿˜æ˜¯åœ¨ Socket çš„å…³é—­ä¸Šï¼Œæ—¢ç„¶æ‰¾åˆ°äº†é—®é¢˜æ‰€åœ¨ï¼Œé‚£ä¹ˆåœ¨ä¸ä¿®æ”¹ FTPClient ä»£ç çš„æ¡ä»¶ä¸‹ï¼Œå¯é‡‡ç”¨å¦‚ä¸‹è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>æ‰©å¤§æœºå™¨å¯ç”¨çš„ç«¯å£èŒƒå›´</li>
<li>å¼€å¯ç«¯å£çš„å¤ç”¨ä¸å¿«é€Ÿå›æ”¶</li>
</ul>
<p>è¿ç»´äººå‘˜æŒ‰ä¸Šè¿°æ–¹æ¡ˆå¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œè®¾ç½®ä¹‹åï¼Œcheckpoint æ•°æ®åˆ° FTP æ—¶ï¼Œæœªå†å‘ç”Ÿç«¯å£è¢«å ç”¨é—®é¢˜ã€‚</p>
<h2 id="03-å‚è€ƒèµ„æ–™"><a href="#03-å‚è€ƒèµ„æ–™" class="headerlink" title="03.å‚è€ƒèµ„æ–™"></a>03.å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="https://bbs.csdn.net/topics/320024769">è¯·æ•™Address already in use: connecté—®é¢˜</a></li>
<li><a href="https://www.cnblogs.com/dasusu/p/10006899.html">è®°å½• FTPClient è¶…æ—¶å¤„ç†çš„ç›¸å…³é—®é¢˜</a></li>
</ul>
]]></content>
      <categories>
        <category>Flink</category>
      </categories>
      <tags>
        <tag>Flink</tag>
      </tags>
  </entry>
  <entry>
    <title>Flink æºç æµ…æ 001ï¼šç®—å­å†…éƒ¨åšäº†ä»€ä¹ˆ</title>
    <url>/2018/05/18/flink/Flink%20%E6%BA%90%E7%A0%81%E6%B5%85%E6%9E%90%20001%EF%BC%9A%E7%AE%97%E5%AD%90%E5%86%85%E9%83%A8%E5%81%9A%E4%BA%86%E4%BB%80%E4%B9%88/</url>
    <content><![CDATA[<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/panda-banner-1.png"></p>
<span id="more"></span>

<blockquote>
<p>ä»è¯»ä¹¦åˆ°å·¥ä½œï¼Œæ–­æ–­ç»­ç»­è®°è¿‡ä¸€äº›ç¬”è®°ï¼Œä½†ä¸€ç›´æ²¡èƒ½åšæŒä¸‹æ¥ã€‚æ€»ç»“äº†å‡ ä¸ªåŸå› ï¼š<br>1.å«Œå¼ƒç¬”è®°çš„æ’ç‰ˆä¸ç¾è§‚<del>å¤ªä¸‘äº†ï¼Œå†™äº†è‡ªå·±éƒ½ä¸æƒ³çœ‹<br>2.è¿½æ±‚ç¬”è®°çš„å¤§è€Œå…¨</del>ä¸»é¢˜è¡ç”Ÿå†…å®¹ç¹æ‚ï¼Œå¤šåˆ°ä¸æƒ³å†™<br>3.æ‡’~æ˜¾è€Œæ˜“è§ğŸ˜‚</p>
<p>ä¸ºäº†èƒ½åšæŒä¸‹å»ï¼Œç‰¹å°†æœ¬ç³»åˆ—æ–‡ç« å‘½åä¸ºã€Šæµ…æã€‹ï¼Œæé†’è‡ªå·±åœ¨æ¯ç¯‡æ–‡ç« ä¸­ï¼Œå°½é‡ç”¨ç®€çŸ­çš„ç¯‡å¹…ã€ç®€æ˜çš„è¯­è¨€å»å¤§è‡´è¯´æ¸…æ¥šä¸€ä¸ªä¸»é¢˜ï¼Œè¦æ›´å¤šåœ°å…³æ³¨ä¸»å¹²è„‰ç»œï¼Œä¸è¦é™·åœ¨ç»†ææœ«èŠ‚ä¸­ã€‚</p>
<p>é—²è¯å°‘å™ï¼Œæœ¬æ–‡æˆ‘ä»¬æ¥çœ‹ä¸‹å½“è°ƒç”¨ Flink ç®—å­çš„æ—¶å€™ï¼Œæ¡†æ¶å†…éƒ¨åšäº†å“ªäº›å·¥ä½œã€‚</p>
</blockquote>
<h2 id="æœ‰è¯·-Word-Count"><a href="#æœ‰è¯·-Word-Count" class="headerlink" title="æœ‰è¯· Word Count"></a>æœ‰è¯· Word Count</h2><p><code>Word Count</code> ä¹‹äºå¤§æ•°æ®æ­£å¦‚ <code>Hello World</code> ä¹‹äºç¼–ç¨‹è¯­è¨€ï¼Œè™½ç„¶ç®€å•ï¼Œä½†æ‰§è¡Œè¿‡ç¨‹å´æ¶‰åŠåˆ°åº•å±‚çš„è¯¸å¤šæ–¹é¢ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ª <code>Flink Word Count</code> ç¤ºä¾‹æ¥å¤ä¹ ä¸‹ <code>Flink</code> ç®—å­çš„ä½¿ç”¨ï¼Œåæ–‡å°†ä»¥ <code>flatMap</code> ä¸ºä¾‹ï¼Œæ¥æ¢ç©¶ç®—å­çš„å†…éƒ¨å®ç°ã€‚</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/flink-word-count.png"></p>
<h2 id="ç›¸å…³æ¦‚å¿µä»‹ç»"><a href="#ç›¸å…³æ¦‚å¿µä»‹ç»" class="headerlink" title="ç›¸å…³æ¦‚å¿µä»‹ç»"></a>ç›¸å…³æ¦‚å¿µä»‹ç»</h2><p>ç£¨åˆ€ä¸è¯¯ç æŸ´åŠŸï¼Œåœ¨æ¢ç´¢ <code>flatMap</code> çš„æ‰§è¡Œæµç¨‹ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸‹ <code>Flink</code> ä½œä¸šä¸­çš„ä¸€äº›æŠ½è±¡ï¼Œå…·ä½“åŒ…æ‹¬ <code>Function</code>ã€<code>StreamOperator</code>ã€<code>Transformation</code>ã€<code>DataStream</code>ã€‚</p>
<p><strong>1.Function</strong></p>
<p>ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°çš„åŸºç±»ï¼Œ<code>Word Count</code> ç¤ºä¾‹ä¸­çš„ <code>Tokenizer</code> å®ç°äº† <code>FlatMapFunction</code>ï¼Œ<code>FlatMapFunction</code> ä¾¿æ˜¯ <code>Function</code> çš„ä¸€ä¸ªå­ç±»</p>
<p><strong>2.StreamOperator</strong></p>
<p><code>Flink</code> ç®—å­åœ¨è¿è¡Œæ—¶çš„ä½“ç°ï¼Œ<code>AbstractUdfStreamOperator</code> æ˜¯å…¶ä¸€ä¸ªæŠ½è±¡å­ç±»ï¼Œè¡¨ç¤ºåŒ…å« <code>Function</code> çš„ <code>StreamOperator</code></p>
<p><strong>3.Transformation</strong></p>
<p>å¯¹ <code>DataStream</code> çš„è½¬æ¢æ“ä½œï¼Œ<code>OneInputTransformation</code> æ˜¯å…¶ä¸€ä¸ªå­ç±»ï¼ŒåŒ…å« <code>OneInputStreamOperator</code></p>
<p><strong>4.DataStream</strong></p>
<p>å¯ä»¥ç®€å•å°†å…¶ç†è§£ä¸ºå¯¹ <code>Transformation</code> å’Œ <code>StreamExecutionEnvironment</code> çš„ä¸Šå±‚å°è£…ï¼Œ<code>SingleOutputStreamOperator</code> æ˜¯å…¶ä¸€ä¸ªå­ç±»</p>
<h2 id="flatMap-æ‰§è¡Œæµç¨‹"><a href="#flatMap-æ‰§è¡Œæµç¨‹" class="headerlink" title="flatMap æ‰§è¡Œæµç¨‹"></a>flatMap æ‰§è¡Œæµç¨‹</h2><p><code>flatMap</code> çš„è°ƒç”¨é“¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/flink-method-doTransform.png"></p>
<p><strong>1.è·å– <code>FlatMapFunction</code> çš„è¿”å›ç±»å‹ï¼Œç„¶åè°ƒç”¨å¸¦è¿”å›ç±»å‹çš„é‡è½½æ–¹æ³•</strong></p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/flink-method-flatmap-1.png"></p>
<p>è°ƒç”¨ <code>flatMap</code> æ–¹æ³•æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šè¿”å›ç±»å‹ï¼Œé‚£ä¹ˆä¼šé€šè¿‡ <code>TypeExtractor</code> æ¥è‡ªåŠ¨æå–è¿”å›ç±»å‹ï¼Œç„¶åå†è°ƒç”¨å¸¦è¿”å›ç±»å‹çš„é‡è½½æ–¹æ³•ã€‚</p>
<p>ä¸Šè¿°ä»£ç ä¸­æœ‰å‡ ä¸ªæœ‰æ„æ€çš„åœ°æ–¹æœ‰å¿…è¦äº†è§£ä¸‹ï¼š</p>
<ul>
<li><code>clean(flatMapper)</code>ï¼šé—­åŒ…æ¸…é™¤ã€‚ç®€å•è§£é‡Šä¸‹ï¼Œå†…éƒ¨ç±»æŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œå¦‚æœå¤–éƒ¨ç±»ä¸å¯åºåˆ—åŒ–ï¼Œé‚£ä¹ˆå†…éƒ¨ç±»å³ä½¿å®ç°äº†åºåˆ—åŒ–æ¥å£ï¼Œä¹Ÿæ˜¯æ— æ³•åºåˆ—åŒ–çš„ï¼Œé—­åŒ…æ¸…é™¤å°±æ˜¯é€šè¿‡å­—èŠ‚ç æŠ€æœ¯ï¼Œå°†å†…éƒ¨ç±»ä¸­æŒæœ‰çš„å¤–éƒ¨ç±»å¼•ç”¨ç»™æ¸…é™¤æ‰ï¼Œæ›´å¤šä¿¡æ¯å¯å‚è€ƒï¼š<a href="https://issues.apache.org/jira/browse/FLINK-1325">FLINK-1325</a>ï¼›</li>
<li><code>Utils.getCallLocationName()</code>ï¼šè·å–æ–¹æ³•çš„è°ƒç”¨ä½ç½®ï¼Œè¯¥åŠŸèƒ½æ˜¯é€šè¿‡ <code>Thread#getStackTrace()</code> å®ç°çš„ï¼Œæˆ‘ä»¬ä¸€èˆ¬å¾ˆå°‘ä½¿ç”¨ï¼Œåœ¨æ¡†æ¶æˆ–å·¥å…·ä¸­ç”¨çš„è¾ƒå¤šï¼›</li>
<li><code>getFlatMapReturnTypes</code> çš„ç¬¬å››ä¸ªå‚æ•°ï¼štrue è¡¨ç¤ºå½“æå–ç±»å‹å¤±è´¥æ—¶ï¼Œè¿”å›ä¸€ä¸ª <code>MissingTypeInfo</code> å®ä¾‹ï¼Œè€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼›</li>
</ul>
<p>2.åˆ›å»º <code>StreamFlatMap</code>ï¼Œè°ƒç”¨ <code>transform</code> æ–¹æ³•</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/flink-datastream-flatmap-2.png"></p>
<p><code>StreamFlatMap</code> æ˜¯ <code>AbstractUdfStreamOperator</code> çš„å­ç±»ï¼Œåœ¨ <code>Flink</code> ä½œä¸šè¿è¡Œæ—¶ï¼Œæ¯æ¥ä¸€æ¡æ•°æ®ï¼Œå…¶ <code>processElement</code> æ–¹æ³•ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå†…éƒ¨å…¶å®å°±æ˜¯è°ƒç”¨ <code>FlatMapFunction</code> çš„ <code>flatMap</code> æ–¹æ³•æ¥å¤„ç†æ•°æ®ã€‚</p>
<p>3.åˆ›å»º <code>SimpleOperatorFactory</code>ï¼Œè°ƒç”¨ <code>doTransform</code> æ–¹æ³•</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/flink-method-transform.png"></p>
<p><code>SimpleOperatorFactory</code> æ˜¯ <code>StreamOperator</code> çš„å·¥å‚ç±»å­ç±»ï¼Œæ˜¯å¯¹å·²æœ‰ <code>StreamOperator</code> çš„å°è£…ï¼Œå¯ä»¥å¯¹ <code>StreamOperator</code> åšä¸€äº›é¢å¤–é…ç½®ï¼Œå¦‚è®¾ç½®ç®—å­é“¾æ¥ç­–ç•¥ã€å®šæ—¶å™¨æœåŠ¡ç­‰ã€‚</p>
<p>4.å®ç°ç”¨æˆ·ä»£ç åˆ° <code>Transformation</code> è½¬æ¢çš„æ ¸å¿ƒé€»è¾‘</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/flink-method-doTransform-1.png"></p>
<p>è¿™é‡Œè¿›å…¥åˆ°åˆ›å»º <code>Transformation</code> çš„æ ¸å¿ƒæµç¨‹ï¼š</p>
<ul>
<li>è§¦å‘å¼‚å¸¸ï¼šå‰é¢æˆ‘ä»¬æåˆ°è¿‡ï¼Œ<code>TypeExtractor#getFlatMapReturnTypes</code> æ–¹æ³•æå–å‡½æ•°çš„è¿”å›ç±»å‹æ—¶ï¼Œç¬¬å››ä¸ªå‚æ•°ç”¨äºæ§åˆ¶ç±»å‹æå–å¤±è´¥æ—¶æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœä¸º trueï¼Œä¸æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯è¿”å› <code>MissingTypeInfo</code>ã€‚å½“å‰æ­¥éª¤çš„ç›®çš„å³æ˜¯ç”¨äºè§¦å‘å¼‚å¸¸ï¼Œå½“ä¸Šä¸€ä¸ª <code>Transformation</code> çš„è¾“å‡ºæ˜¯ <code>MissingTypeInfo</code> æ—¶ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼›</li>
<li>åˆ›å»º <code>OneInputTransformation</code>ï¼šå¯ä»¥å‘ç°ï¼Œ<code>OneInputTransformation</code> é™¤äº†åŒ…å« <code>StreamOperator</code> å¤–ï¼Œè¿˜è®°å½•äº†ä¸Šæ¸¸ <code>Transformation</code>ã€è¾“å‡ºç±»å‹ã€å¹¶è¡Œåº¦ç­‰ä¿¡æ¯ï¼›</li>
<li>å°† <code>Transformation</code> å’Œ <code>StreamExecutionEnvironment</code> å°è£…ä¸º <code>DataStream</code>ï¼Œè¿™é‡Œæ˜¯ <code>SingleOutputStreamOperator</code>ï¼›</li>
<li>å°† <code>Transformation</code> è®°å½•åˆ° <code>StreamExecutionEnvironment</code>ï¼š<code>StreamExecutionEnvironment</code> æœ‰ä¸ªåˆ—è¡¨ç±»å‹çš„æˆå‘˜å˜é‡ <code>transformations</code>ï¼Œç”¨äºé¡ºåºè®°å½• <code>Flink</code> ä½œä¸šä¸­åŒ…å«çš„ <code>Transformation</code>ï¼Œåç»­å°†éå†è¯¥æˆå‘˜å˜é‡æ¥åˆ›å»º <code>StreamGraph</code>ï¼›</li>
<li>è¿”å› DataStreamï¼Œç»§ç»­æ‰§è¡Œè½¬æ¢ï¼›</li>
</ul>
<p>ç†Ÿæ‚‰ <code>Flink</code> çš„ç”¨æˆ·åº”è¯¥çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>setParallelism</code> æ–¹æ³•æ¥æŒ‡å®šç®—å­çš„å¹¶è¡Œåº¦ï¼Œå…¶æ–¹æ³•å®ç°å¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/flink-method-setParallelism.png"></p>
<p>å¯ä»¥å‘ç°ï¼Œè¿™é‡Œå…¶å®æ˜¯è®¾ç½®  <code>Transformation</code>  çš„å¹¶è¡Œåº¦ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„ <code>Transformation</code> éƒ½æ˜¯å¯ä»¥å¹¶è¡Œçš„ï¼Œæ‰€ä»¥è®¾ç½®ä¹‹å‰ï¼Œä¼šå…ˆå¯¹å¹¶è¡Œåº¦çš„åˆæ³•æ€§è¿›è¡Œæ ¡éªŒã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç”¨æˆ·ç®—å­çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯åˆ›å»º <code>Transformation</code> çš„è¿‡ç¨‹ï¼Œè¿™äº› <code>Transformation</code> è®°å½•åœ¨ <code>StreamExecutionEnvironment</code> ä¸­ï¼Œåç»­å°†åŸºäºæ­¤æ¥åˆ›å»º <code>StreamGraph</code>ã€‚</p>
]]></content>
      <categories>
        <category>Flink</category>
      </categories>
      <tags>
        <tag>Flink</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo çš„ Next ä¸»é¢˜ç¾åŒ–</title>
    <url>/2022/06/06/other/Hexo%20%E7%9A%84%20Next%20%E4%B8%BB%E9%A2%98%E7%BE%8E%E5%8C%96/</url>
    <content><![CDATA[<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/panda-banner-1.png"></p>
<span id="more"></span>

<h2 id="01-NexT-ä¸»é¢˜çš„ä¸‹è½½ä¸å®‰è£…"><a href="#01-NexT-ä¸»é¢˜çš„ä¸‹è½½ä¸å®‰è£…" class="headerlink" title="01.NexT ä¸»é¢˜çš„ä¸‹è½½ä¸å®‰è£…"></a>01.NexT ä¸»é¢˜çš„ä¸‹è½½ä¸å®‰è£…</h2><ul>
<li>ä¸‹è½½ <a href="https://github.com/theme-next/hexo-theme-next/releases">NexT</a> ä¸»é¢˜å¹¶å°†å…¶è§£å‹åˆ°åšå®¢çš„ themes ç›®å½•ä¸‹ï¼Œä¿®æ”¹åç§°ä¸º nextï¼›</li>
<li>ä¿®æ”¹åšå®¢æ ¹ç›®å½•ä¸‹çš„ _config.ymlï¼Œå°† theme é¡¹è®¾ç½®ä¸º next;</li>
</ul>
<h2 id="02-è®¾ç½®-NexT-ä¸»é¢˜æ ·å¼"><a href="#02-è®¾ç½®-NexT-ä¸»é¢˜æ ·å¼" class="headerlink" title="02.è®¾ç½® NexT ä¸»é¢˜æ ·å¼"></a>02.è®¾ç½® NexT ä¸»é¢˜æ ·å¼</h2><p>ç¼–è¾‘ next ä¸»é¢˜ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶ï¼Œæ‰“å¼€ç›¸åº” schema çš„æ³¨é‡Šï¼Œç»†èŠ‚å¦‚ä¸‹ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># Scheme Settings</span></span><br><span class="line"><span class="comment"># ---------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Schemes</span></span><br><span class="line"><span class="comment">#scheme: Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Gemini</span></span><br></pre></td></tr></table></figure>

<h2 id="03-è®¾ç½®-Hexo-ä½¿ç”¨ä¸­æ–‡"><a href="#03-è®¾ç½®-Hexo-ä½¿ç”¨ä¸­æ–‡" class="headerlink" title="03.è®¾ç½® Hexo ä½¿ç”¨ä¸­æ–‡"></a>03.è®¾ç½® Hexo ä½¿ç”¨ä¸­æ–‡</h2><p>ç¼–è¾‘åšå®¢æ ¹ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶ï¼Œä¿®æ”¹ language é¡¹ï¼Œç»†èŠ‚å¦‚ä¸‹ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br></pre></td></tr></table></figure>

<h2 id="04-è®¾ç½®-NexT-ä¸»é¢˜å¤´åƒ"><a href="#04-è®¾ç½®-NexT-ä¸»é¢˜å¤´åƒ" class="headerlink" title="04.è®¾ç½® NexT ä¸»é¢˜å¤´åƒ"></a>04.è®¾ç½® NexT ä¸»é¢˜å¤´åƒ</h2><p>ç¼–è¾‘ next ä¸»é¢˜ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶ï¼Œå…·ä½“è®¾ç½®å¦‚ä¸‹ï¼ˆ<code>images</code> ä½äº <code>themes/next/source</code> ä¸‹ï¼‰ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="comment"># å¤´åƒå›¾ç‰‡</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">/images/gakki.png</span></span><br><span class="line">  <span class="comment"># å¤´åƒä¸ºåœ†å½¢</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># é¼ æ ‡ç§»åŠ¨åˆ°å¤´åƒæ—¶ï¼Œå¤´åƒæ—‹è½¬</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="05-è®¾ç½®åšå®¢æ ‡é¢˜ã€ä½œè€…ä¿¡æ¯"><a href="#05-è®¾ç½®åšå®¢æ ‡é¢˜ã€ä½œè€…ä¿¡æ¯" class="headerlink" title="05.è®¾ç½®åšå®¢æ ‡é¢˜ã€ä½œè€…ä¿¡æ¯"></a>05.è®¾ç½®åšå®¢æ ‡é¢˜ã€ä½œè€…ä¿¡æ¯</h2><p>ç¼–è¾‘åšå®¢æ ¹ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶ï¼Œå…·ä½“è®¾ç½®å¦‚ä¸‹ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">Leo&#x27;s</span> <span class="string">Blog</span> <span class="comment">#æ ‡é¢˜</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;åæ ‡æ­å·ï¼Œå–é©¬ä¸ºç”Ÿ&#x27;</span> <span class="comment">#å­æ ‡é¢˜</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Leo</span> <span class="comment">#ä½œè€…ä¿¡æ¯</span></span><br></pre></td></tr></table></figure>

<h2 id="06-è®¾ç½®åšå®¢åŠ¨æ€èƒŒæ™¯"><a href="#06-è®¾ç½®åšå®¢åŠ¨æ€èƒŒæ™¯" class="headerlink" title="06.è®¾ç½®åšå®¢åŠ¨æ€èƒŒæ™¯"></a>06.è®¾ç½®åšå®¢åŠ¨æ€èƒŒæ™¯</h2><p>å¯ç”¨ three èƒŒæ™¯çš„æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.è¿›å…¥ next ä¸»é¢˜ç›®å½•</span></span><br><span class="line"><span class="string">cd</span> <span class="string">themes/next</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ‹‰å– three èƒŒæ™¯ä¾èµ–</span></span><br><span class="line"><span class="string">git</span> <span class="string">clone</span> <span class="string">https://github.com/theme-next/theme-next-three</span> <span class="string">source/lib/three</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.ç¼–è¾‘ next ä¸»é¢˜ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶</span></span><br><span class="line"><span class="attr">three:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">three_waves:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">canvas_lines:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">canvas_sphere:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>å¯ç”¨ canvas-nest èƒŒæ™¯çš„æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.è¿›å…¥ next ä¸»é¢˜ç›®å½•</span></span><br><span class="line"><span class="string">cd</span> <span class="string">themes/next</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ‹‰å– canvas-next èƒŒæ™¯ä¾èµ–</span></span><br><span class="line"><span class="string">git</span> <span class="string">clone</span> <span class="string">https://github.com/theme-next/theme-next-canvas-nest</span> <span class="string">source/lib/canvas-nest</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.ç¼–è¾‘ next ä¸»é¢˜ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶</span></span><br><span class="line"><span class="attr">canvas_nest:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">onmobile:</span> <span class="literal">true</span> <span class="comment"># Display on mobile or not</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;0,0,255&quot;</span> <span class="comment"># RGB values, use `,` to separate</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.5</span> <span class="comment"># The opacity of line: 0~1</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># z-index property of the background</span></span><br><span class="line">  <span class="attr">count:</span> <span class="number">150</span> <span class="comment"># The number of lines, default 99</span></span><br></pre></td></tr></table></figure>

<p>å¯ç”¨ canvas-ribbon èƒŒæ™¯çš„æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.è¿›å…¥ next ä¸»é¢˜ç›®å½•</span></span><br><span class="line"><span class="string">cd</span> <span class="string">themes/next</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ‹‰å– canvas-ribbon èƒŒæ™¯ä¾èµ–</span></span><br><span class="line"><span class="string">git</span> <span class="string">clone</span> <span class="string">https://github.com/theme-next/theme-next-canvas-ribbon</span> <span class="string">source/lib/canvas-ribbon</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.ç¼–è¾‘ next ä¸»é¢˜ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶</span></span><br><span class="line"><span class="attr">canvas_ribbon:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">size:</span> <span class="number">300</span> <span class="comment"># The width of the ribbon</span></span><br><span class="line">  <span class="attr">alpha:</span> <span class="number">0.6</span> <span class="comment"># The transparency of the ribbon</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># The display level of the ribbon</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æç¤º1ï¼šè¦åˆ é™¤ clone ä¸‹æ¥çš„ä¾èµ–åŒ…ä¸­çš„ .git æ–‡ä»¶å¤¹</p>
<p>æç¤º2ï¼šå¦‚æœä¸‹è½½çš„ä¾èµ–æ— æ³•æäº¤åˆ° githubï¼Œåˆ™å¯èƒ½æ˜¯ç”± next ç›®å½•ä¸‹çš„ .gitignore å¼•èµ·çš„</p>
<p>æç¤º3ï¼šæˆ‘ä½¿ç”¨çš„åŠ¨æ€èƒŒæ™¯æ˜¯ canvas-nest</p>
</blockquote>
<h2 id="07-è®¾ç½®é¡µé¢åŠ è½½æ•ˆæœ"><a href="#07-è®¾ç½®é¡µé¢åŠ è½½æ•ˆæœ" class="headerlink" title="07.è®¾ç½®é¡µé¢åŠ è½½æ•ˆæœ"></a>07.è®¾ç½®é¡µé¢åŠ è½½æ•ˆæœ</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 1.è¿›å…¥ next ä¸»é¢˜ç›®å½•</span></span><br><span class="line"><span class="string">cd</span> <span class="string">themes/next</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.æ‹‰å– three èƒŒæ™¯ä¾èµ–</span></span><br><span class="line"><span class="string">git</span> <span class="string">clone</span> <span class="string">https://github.com/theme-next/theme-next-pace</span> <span class="string">source/lib/pace</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.ç¼–è¾‘ next ä¸»é¢˜ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶</span></span><br><span class="line"><span class="attr">pace:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Themes list:</span></span><br><span class="line">  <span class="comment"># big-counter | bounce | barber-shop | center-atom </span></span><br><span class="line">  <span class="comment"># center-circle | center-radar | center-simple</span></span><br><span class="line">  <span class="comment"># corner-indicator | fill-left | flat-top | flash </span></span><br><span class="line">  <span class="comment"># loading-bar | mac-osx | material | minimal</span></span><br><span class="line">  <span class="attr">theme:</span> <span class="string">center-atom</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æç¤º1ï¼šè¦åˆ é™¤ clone ä¸‹æ¥çš„ä¾èµ–åŒ…ä¸­çš„ .git æ–‡ä»¶å¤¹</p>
<p>æç¤º2ï¼šå¦‚æœä¸‹è½½çš„ä¾èµ–æ— æ³•æäº¤åˆ° githubï¼Œåˆ™å¯èƒ½æ˜¯ç”± next ç›®å½•ä¸‹çš„ .gitignore å¼•èµ·çš„</p>
</blockquote>
<h2 id="08-è®¾ç½®é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ"><a href="#08-è®¾ç½®é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ" class="headerlink" title="08.è®¾ç½®é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ"></a>08.è®¾ç½®é¼ æ ‡ç‚¹å‡»ç‰¹æ•ˆ</h2><p>é¦–å…ˆåœ¨ themes&#x2F;next&#x2F;source&#x2F;js&#x2F;src é‡Œé¢å»ºä¸€ä¸ªå« fireworks.js çš„æ–‡ä»¶ï¼ˆ<code>src</code> æ–‡ä»¶å¤¹éœ€è¦è‡ªå·±åˆ›å»ºï¼‰ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;<span class="keyword">function</span> <span class="title function_">updateCoords</span>(<span class="params">e</span>)&#123;pointerX=(e.<span class="property">clientX</span>||e.<span class="property">touches</span>[<span class="number">0</span>].<span class="property">clientX</span>)-canvasEl.<span class="title function_">getBoundingClientRect</span>().<span class="property">left</span>,pointerY=e.<span class="property">clientY</span>||e.<span class="property">touches</span>[<span class="number">0</span>].<span class="property">clientY</span>-canvasEl.<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span>&#125;<span class="keyword">function</span> <span class="title function_">setParticuleDirection</span>(<span class="params">e</span>)&#123;<span class="keyword">var</span> t=anime.<span class="title function_">random</span>(<span class="number">0</span>,<span class="number">360</span>)*<span class="title class_">Math</span>.<span class="property">PI</span>/<span class="number">180</span>,a=anime.<span class="title function_">random</span>(<span class="number">50</span>,<span class="number">180</span>),n=[-<span class="number">1</span>,<span class="number">1</span>][anime.<span class="title function_">random</span>(<span class="number">0</span>,<span class="number">1</span>)]*a;<span class="keyword">return</span>&#123;<span class="attr">x</span>:e.<span class="property">x</span>+n*<span class="title class_">Math</span>.<span class="title function_">cos</span>(t),<span class="attr">y</span>:e.<span class="property">y</span>+n*<span class="title class_">Math</span>.<span class="title function_">sin</span>(t)&#125;&#125;<span class="keyword">function</span> <span class="title function_">createParticule</span>(<span class="params">e,t</span>)&#123;<span class="keyword">var</span> a=&#123;&#125;;<span class="keyword">return</span> a.<span class="property">x</span>=e,a.<span class="property">y</span>=t,a.<span class="property">color</span>=colors[anime.<span class="title function_">random</span>(<span class="number">0</span>,colors.<span class="property">length</span>-<span class="number">1</span>)],a.<span class="property">radius</span>=anime.<span class="title function_">random</span>(<span class="number">16</span>,<span class="number">32</span>),a.<span class="property">endPos</span>=<span class="title function_">setParticuleDirection</span>(a),a.<span class="property">draw</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;ctx.<span class="title function_">beginPath</span>(),ctx.<span class="title function_">arc</span>(a.<span class="property">x</span>,a.<span class="property">y</span>,a.<span class="property">radius</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">0</span>),ctx.<span class="property">fillStyle</span>=a.<span class="property">color</span>,ctx.<span class="title function_">fill</span>()&#125;,a&#125;<span class="keyword">function</span> <span class="title function_">createCircle</span>(<span class="params">e,t</span>)&#123;<span class="keyword">var</span> a=&#123;&#125;;<span class="keyword">return</span> a.<span class="property">x</span>=e,a.<span class="property">y</span>=t,a.<span class="property">color</span>=<span class="string">&quot;#F00&quot;</span>,a.<span class="property">radius</span>=<span class="number">0.1</span>,a.<span class="property">alpha</span>=<span class="number">0.5</span>,a.<span class="property">lineWidth</span>=<span class="number">6</span>,a.<span class="property">draw</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;ctx.<span class="property">globalAlpha</span>=a.<span class="property">alpha</span>,ctx.<span class="title function_">beginPath</span>(),ctx.<span class="title function_">arc</span>(a.<span class="property">x</span>,a.<span class="property">y</span>,a.<span class="property">radius</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">0</span>),ctx.<span class="property">lineWidth</span>=a.<span class="property">lineWidth</span>,ctx.<span class="property">strokeStyle</span>=a.<span class="property">color</span>,ctx.<span class="title function_">stroke</span>(),ctx.<span class="property">globalAlpha</span>=<span class="number">1</span>&#125;,a&#125;<span class="keyword">function</span> <span class="title function_">renderParticule</span>(<span class="params">e</span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;e.<span class="property">animatables</span>.<span class="property">length</span>;t++)&#123;e.<span class="property">animatables</span>[t].<span class="property">target</span>.<span class="title function_">draw</span>()&#125;&#125;<span class="keyword">function</span> <span class="title function_">animateParticules</span>(<span class="params">e,t</span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="title function_">createCircle</span>(e,t),n=[],i=<span class="number">0</span>;i&lt;numberOfParticules;i++)&#123;n.<span class="title function_">push</span>(<span class="title function_">createParticule</span>(e,t))&#125;anime.<span class="title function_">timeline</span>().<span class="title function_">add</span>(&#123;<span class="attr">targets</span>:n,<span class="attr">x</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123;<span class="keyword">return</span> e.<span class="property">endPos</span>.<span class="property">x</span>&#125;,<span class="attr">y</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123;<span class="keyword">return</span> e.<span class="property">endPos</span>.<span class="property">y</span>&#125;,<span class="attr">radius</span>:<span class="number">0.1</span>,<span class="attr">duration</span>:anime.<span class="title function_">random</span>(<span class="number">1200</span>,<span class="number">1800</span>),<span class="attr">easing</span>:<span class="string">&quot;easeOutExpo&quot;</span>,<span class="attr">update</span>:renderParticule&#125;).<span class="title function_">add</span>(&#123;<span class="attr">targets</span>:a,<span class="attr">radius</span>:anime.<span class="title function_">random</span>(<span class="number">80</span>,<span class="number">160</span>),<span class="attr">lineWidth</span>:<span class="number">0</span>,<span class="attr">alpha</span>:&#123;<span class="attr">value</span>:<span class="number">0</span>,<span class="attr">easing</span>:<span class="string">&quot;linear&quot;</span>,<span class="attr">duration</span>:anime.<span class="title function_">random</span>(<span class="number">600</span>,<span class="number">800</span>)&#125;,<span class="attr">duration</span>:anime.<span class="title function_">random</span>(<span class="number">1200</span>,<span class="number">1800</span>),<span class="attr">easing</span>:<span class="string">&quot;easeOutExpo&quot;</span>,<span class="attr">update</span>:renderParticule,<span class="attr">offset</span>:<span class="number">0</span>&#125;)&#125;<span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">e,t</span>)&#123;<span class="keyword">var</span> a;<span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> n=<span class="variable language_">this</span>,i=<span class="variable language_">arguments</span>;<span class="built_in">clearTimeout</span>(a),a=<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;e.<span class="title function_">apply</span>(n,i)&#125;,t)&#125;&#125;<span class="keyword">var</span> canvasEl=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.fireworks&quot;</span>);<span class="keyword">if</span>(canvasEl)&#123;<span class="keyword">var</span> ctx=canvasEl.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>),numberOfParticules=<span class="number">30</span>,pointerX=<span class="number">0</span>,pointerY=<span class="number">0</span>,tap=<span class="string">&quot;mousedown&quot;</span>,colors=[<span class="string">&quot;#FF1461&quot;</span>,<span class="string">&quot;#18FF92&quot;</span>,<span class="string">&quot;#5A87FF&quot;</span>,<span class="string">&quot;#FBF38C&quot;</span>],setCanvasSize=<span class="title function_">debounce</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;canvasEl.<span class="property">width</span>=<span class="number">2</span>*<span class="variable language_">window</span>.<span class="property">innerWidth</span>,canvasEl.<span class="property">height</span>=<span class="number">2</span>*<span class="variable language_">window</span>.<span class="property">innerHeight</span>,canvasEl.<span class="property">style</span>.<span class="property">width</span>=<span class="variable language_">window</span>.<span class="property">innerWidth</span>+<span class="string">&quot;px&quot;</span>,canvasEl.<span class="property">style</span>.<span class="property">height</span>=<span class="variable language_">window</span>.<span class="property">innerHeight</span>+<span class="string">&quot;px&quot;</span>,canvasEl.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>).<span class="title function_">scale</span>(<span class="number">2</span>,<span class="number">2</span>)&#125;,<span class="number">500</span>),render=<span class="title function_">anime</span>(&#123;<span class="attr">duration</span>:<span class="number">1</span>/<span class="number">0</span>,<span class="attr">update</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>,<span class="number">0</span>,canvasEl.<span class="property">width</span>,canvasEl.<span class="property">height</span>)&#125;&#125;);<span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(tap,<span class="keyword">function</span>(<span class="params">e</span>)&#123;<span class="string">&quot;sidebar&quot;</span>!==e.<span class="property">target</span>.<span class="property">id</span>&amp;&amp;<span class="string">&quot;toggle-sidebar&quot;</span>!==e.<span class="property">target</span>.<span class="property">id</span>&amp;&amp;<span class="string">&quot;A&quot;</span>!==e.<span class="property">target</span>.<span class="property">nodeName</span>&amp;&amp;<span class="string">&quot;IMG&quot;</span>!==e.<span class="property">target</span>.<span class="property">nodeName</span>&amp;&amp;(render.<span class="title function_">play</span>(),<span class="title function_">updateCoords</span>(e),<span class="title function_">animateParticules</span>(pointerX,pointerY))&#125;,!<span class="number">1</span>),<span class="title function_">setCanvasSize</span>(),<span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;resize&quot;</span>,setCanvasSize,!<span class="number">1</span>)&#125;<span class="string">&quot;use strict&quot;</span>;<span class="keyword">function</span> <span class="title function_">updateCoords</span>(<span class="params">e</span>)&#123;pointerX=(e.<span class="property">clientX</span>||e.<span class="property">touches</span>[<span class="number">0</span>].<span class="property">clientX</span>)-canvasEl.<span class="title function_">getBoundingClientRect</span>().<span class="property">left</span>,pointerY=e.<span class="property">clientY</span>||e.<span class="property">touches</span>[<span class="number">0</span>].<span class="property">clientY</span>-canvasEl.<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span>&#125;<span class="keyword">function</span> <span class="title function_">setParticuleDirection</span>(<span class="params">e</span>)&#123;<span class="keyword">var</span> t=anime.<span class="title function_">random</span>(<span class="number">0</span>,<span class="number">360</span>)*<span class="title class_">Math</span>.<span class="property">PI</span>/<span class="number">180</span>,a=anime.<span class="title function_">random</span>(<span class="number">50</span>,<span class="number">180</span>),n=[-<span class="number">1</span>,<span class="number">1</span>][anime.<span class="title function_">random</span>(<span class="number">0</span>,<span class="number">1</span>)]*a;<span class="keyword">return</span>&#123;<span class="attr">x</span>:e.<span class="property">x</span>+n*<span class="title class_">Math</span>.<span class="title function_">cos</span>(t),<span class="attr">y</span>:e.<span class="property">y</span>+n*<span class="title class_">Math</span>.<span class="title function_">sin</span>(t)&#125;&#125;<span class="keyword">function</span> <span class="title function_">createParticule</span>(<span class="params">e,t</span>)&#123;<span class="keyword">var</span> a=&#123;&#125;;<span class="keyword">return</span> a.<span class="property">x</span>=e,a.<span class="property">y</span>=t,a.<span class="property">color</span>=colors[anime.<span class="title function_">random</span>(<span class="number">0</span>,colors.<span class="property">length</span>-<span class="number">1</span>)],a.<span class="property">radius</span>=anime.<span class="title function_">random</span>(<span class="number">16</span>,<span class="number">32</span>),a.<span class="property">endPos</span>=<span class="title function_">setParticuleDirection</span>(a),a.<span class="property">draw</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;ctx.<span class="title function_">beginPath</span>(),ctx.<span class="title function_">arc</span>(a.<span class="property">x</span>,a.<span class="property">y</span>,a.<span class="property">radius</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">0</span>),ctx.<span class="property">fillStyle</span>=a.<span class="property">color</span>,ctx.<span class="title function_">fill</span>()&#125;,a&#125;<span class="keyword">function</span> <span class="title function_">createCircle</span>(<span class="params">e,t</span>)&#123;<span class="keyword">var</span> a=&#123;&#125;;<span class="keyword">return</span> a.<span class="property">x</span>=e,a.<span class="property">y</span>=t,a.<span class="property">color</span>=<span class="string">&quot;#F00&quot;</span>,a.<span class="property">radius</span>=<span class="number">0.1</span>,a.<span class="property">alpha</span>=<span class="number">0.5</span>,a.<span class="property">lineWidth</span>=<span class="number">6</span>,a.<span class="property">draw</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;ctx.<span class="property">globalAlpha</span>=a.<span class="property">alpha</span>,ctx.<span class="title function_">beginPath</span>(),ctx.<span class="title function_">arc</span>(a.<span class="property">x</span>,a.<span class="property">y</span>,a.<span class="property">radius</span>,<span class="number">0</span>,<span class="number">2</span>*<span class="title class_">Math</span>.<span class="property">PI</span>,!<span class="number">0</span>),ctx.<span class="property">lineWidth</span>=a.<span class="property">lineWidth</span>,ctx.<span class="property">strokeStyle</span>=a.<span class="property">color</span>,ctx.<span class="title function_">stroke</span>(),ctx.<span class="property">globalAlpha</span>=<span class="number">1</span>&#125;,a&#125;<span class="keyword">function</span> <span class="title function_">renderParticule</span>(<span class="params">e</span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> t=<span class="number">0</span>;t&lt;e.<span class="property">animatables</span>.<span class="property">length</span>;t++)&#123;e.<span class="property">animatables</span>[t].<span class="property">target</span>.<span class="title function_">draw</span>()&#125;&#125;<span class="keyword">function</span> <span class="title function_">animateParticules</span>(<span class="params">e,t</span>)&#123;<span class="keyword">for</span>(<span class="keyword">var</span> a=<span class="title function_">createCircle</span>(e,t),n=[],i=<span class="number">0</span>;i&lt;numberOfParticules;i++)&#123;n.<span class="title function_">push</span>(<span class="title function_">createParticule</span>(e,t))&#125;anime.<span class="title function_">timeline</span>().<span class="title function_">add</span>(&#123;<span class="attr">targets</span>:n,<span class="attr">x</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123;<span class="keyword">return</span> e.<span class="property">endPos</span>.<span class="property">x</span>&#125;,<span class="attr">y</span>:<span class="keyword">function</span>(<span class="params">e</span>)&#123;<span class="keyword">return</span> e.<span class="property">endPos</span>.<span class="property">y</span>&#125;,<span class="attr">radius</span>:<span class="number">0.1</span>,<span class="attr">duration</span>:anime.<span class="title function_">random</span>(<span class="number">1200</span>,<span class="number">1800</span>),<span class="attr">easing</span>:<span class="string">&quot;easeOutExpo&quot;</span>,<span class="attr">update</span>:renderParticule&#125;).<span class="title function_">add</span>(&#123;<span class="attr">targets</span>:a,<span class="attr">radius</span>:anime.<span class="title function_">random</span>(<span class="number">80</span>,<span class="number">160</span>),<span class="attr">lineWidth</span>:<span class="number">0</span>,<span class="attr">alpha</span>:&#123;<span class="attr">value</span>:<span class="number">0</span>,<span class="attr">easing</span>:<span class="string">&quot;linear&quot;</span>,<span class="attr">duration</span>:anime.<span class="title function_">random</span>(<span class="number">600</span>,<span class="number">800</span>)&#125;,<span class="attr">duration</span>:anime.<span class="title function_">random</span>(<span class="number">1200</span>,<span class="number">1800</span>),<span class="attr">easing</span>:<span class="string">&quot;easeOutExpo&quot;</span>,<span class="attr">update</span>:renderParticule,<span class="attr">offset</span>:<span class="number">0</span>&#125;)&#125;<span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">e,t</span>)&#123;<span class="keyword">var</span> a;<span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="keyword">var</span> n=<span class="variable language_">this</span>,i=<span class="variable language_">arguments</span>;<span class="built_in">clearTimeout</span>(a),a=<span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;e.<span class="title function_">apply</span>(n,i)&#125;,t)&#125;&#125;<span class="keyword">var</span> canvasEl=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.fireworks&quot;</span>);<span class="keyword">if</span>(canvasEl)&#123;<span class="keyword">var</span> ctx=canvasEl.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>),numberOfParticules=<span class="number">30</span>,pointerX=<span class="number">0</span>,pointerY=<span class="number">0</span>,tap=<span class="string">&quot;mousedown&quot;</span>,colors=[<span class="string">&quot;#FF1461&quot;</span>,<span class="string">&quot;#18FF92&quot;</span>,<span class="string">&quot;#5A87FF&quot;</span>,<span class="string">&quot;#FBF38C&quot;</span>],setCanvasSize=<span class="title function_">debounce</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;canvasEl.<span class="property">width</span>=<span class="number">2</span>*<span class="variable language_">window</span>.<span class="property">innerWidth</span>,canvasEl.<span class="property">height</span>=<span class="number">2</span>*<span class="variable language_">window</span>.<span class="property">innerHeight</span>,canvasEl.<span class="property">style</span>.<span class="property">width</span>=<span class="variable language_">window</span>.<span class="property">innerWidth</span>+<span class="string">&quot;px&quot;</span>,canvasEl.<span class="property">style</span>.<span class="property">height</span>=<span class="variable language_">window</span>.<span class="property">innerHeight</span>+<span class="string">&quot;px&quot;</span>,canvasEl.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>).<span class="title function_">scale</span>(<span class="number">2</span>,<span class="number">2</span>)&#125;,<span class="number">500</span>),render=<span class="title function_">anime</span>(&#123;<span class="attr">duration</span>:<span class="number">1</span>/<span class="number">0</span>,<span class="attr">update</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>,<span class="number">0</span>,canvasEl.<span class="property">width</span>,canvasEl.<span class="property">height</span>)&#125;&#125;);<span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(tap,<span class="keyword">function</span>(<span class="params">e</span>)&#123;<span class="string">&quot;sidebar&quot;</span>!==e.<span class="property">target</span>.<span class="property">id</span>&amp;&amp;<span class="string">&quot;toggle-sidebar&quot;</span>!==e.<span class="property">target</span>.<span class="property">id</span>&amp;&amp;<span class="string">&quot;A&quot;</span>!==e.<span class="property">target</span>.<span class="property">nodeName</span>&amp;&amp;<span class="string">&quot;IMG&quot;</span>!==e.<span class="property">target</span>.<span class="property">nodeName</span>&amp;&amp;(render.<span class="title function_">play</span>(),<span class="title function_">updateCoords</span>(e),<span class="title function_">animateParticules</span>(pointerX,pointerY))&#125;,!<span class="number">1</span>),<span class="title function_">setCanvasSize</span>(),<span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;resize&quot;</span>,setCanvasSize,!<span class="number">1</span>)&#125;;</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ themes&#x2F;next&#x2F;layout&#x2F;_layout.swig ,åœ¨ <code>&lt;/body&gt;</code> æ ‡ç­¾ä¸Šæ–¹æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% if theme.fireworks %&#125;</span><br><span class="line">   <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">class</span>=<span class="string">&quot;fireworks&quot;</span> <span class="attr">style</span>=<span class="string">&quot;position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span> </span><br><span class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//cdn.bootcss.com/animejs/2.2.0/anime.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line">   <span class="comment">&lt;!-- js è„šæœ¬çš„åœ°å€éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œè°ƒæ•´ --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/js/src/fireworks.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Fireworks</span></span><br><span class="line"><span class="attr">fireworks:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æç¤º1ï¼šå¦‚æœ src ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨åˆ›å»º</p>
<p>æç¤º2ï¼šåœ¨ _layout.swig ä¸­æ·»åŠ ä»£ç æ—¶ï¼Œæ³¨æ„æ˜¯å¦éœ€è¦è°ƒæ•´ js è„šæœ¬çš„è·¯å¾„ã€‚å¦‚æœåšå®¢çš„ root åœ°å€æ˜¯ &#x2F; åˆ™æ— éœ€ä¿®æ”¹ï¼Œå¦‚è¿‡åšå®¢çš„ root åœ°å€æ˜¯ &#x2F;blog&#x2F;ï¼Œåˆ™ js è„šæœ¬çš„åœ°å€å‰é¢å°±éœ€è¦åŠ ä¸Š &#x2F;blog </p>
</blockquote>
<h2 id="09-å–æ¶ˆç›®å½•ä¸­æ ‡é¢˜è‡ªåŠ¨ç¼–å·"><a href="#09-å–æ¶ˆç›®å½•ä¸­æ ‡é¢˜è‡ªåŠ¨ç¼–å·" class="headerlink" title="09.å–æ¶ˆç›®å½•ä¸­æ ‡é¢˜è‡ªåŠ¨ç¼–å·"></a>09.å–æ¶ˆç›®å½•ä¸­æ ‡é¢˜è‡ªåŠ¨ç¼–å·</h2><p>æ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">expand_all:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">max_depth:</span> <span class="number">6</span></span><br></pre></td></tr></table></figure>

<h2 id="10-éšè—é¡µé¢åº•éƒ¨æ–‡å­—"><a href="#10-éšè—é¡µé¢åº•éƒ¨æ–‡å­—" class="headerlink" title="10.éšè—é¡µé¢åº•éƒ¨æ–‡å­—"></a>10.éšè—é¡µé¢åº•éƒ¨æ–‡å­—</h2><p>æ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Powered by Hexo &amp; NexT</span></span><br><span class="line"><span class="attr">powered:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ <code>themes/next/layout/_partials/footer.swig</code>ï¼Œæ³¨é‡Šæ‰å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&lt;div class=&quot;copyright&quot;&gt;</span></span><br><span class="line"><span class="comment">  ......</span></span><br><span class="line"><span class="comment">&lt;/div&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="11-è®¾ç½®åšå®¢é¡µé¢é€æ˜åº¦"><a href="#11-è®¾ç½®åšå®¢é¡µé¢é€æ˜åº¦" class="headerlink" title="11.è®¾ç½®åšå®¢é¡µé¢é€æ˜åº¦"></a>11.è®¾ç½®åšå®¢é¡µé¢é€æ˜åº¦</h2><p>æ‰“å¼€ themes\next\source\css\_schemes\Pisces\_layout.styl</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.header-inner</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.3</span>);</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ themes\next\source\css\_schemes\Gemini\index.styl</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.content-wrap</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.3</span>);</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.post-block</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.3</span>);</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.comments</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.3</span>);</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pagination</span> &#123;</span><br><span class="line">  ......</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.3</span>);</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ themes\next\source\css\_schemes\Pisces\_sidebar.styl</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.sidebar</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.3</span>);</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.sidebar-inner</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.3</span>);</span><br><span class="line">  ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-æ˜¾ç¤ºæ–‡ç« é˜…è¯»è¿›åº¦"><a href="#12-æ˜¾ç¤ºæ–‡ç« é˜…è¯»è¿›åº¦" class="headerlink" title="12.æ˜¾ç¤ºæ–‡ç« é˜…è¯»è¿›åº¦"></a>12.æ˜¾ç¤ºæ–‡ç« é˜…è¯»è¿›åº¦</h2><p>æ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¼šåœ¨ back2top æŒ‰é’®ä¸Šæ˜¾ç¤ºé˜…è¯»ç™¾åˆ†æ¯”</span></span><br><span class="line"><span class="attr">back2top:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Back to top in sidebar.</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Scroll percent label in b2t button.</span></span><br><span class="line">  <span class="attr">scrollpercent:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¼šåœ¨é¡µé¢ä¸Šæ–¹æ˜¾ç¤ºä¸€ä¸ªé˜…è¯»è¿›åº¦æ¡</span></span><br><span class="line"><span class="attr">reading_progress:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Available values: top | bottom</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">top</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#37c6c0&quot;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">3px</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æç¤ºï¼šæ²¡å¿…è¦éƒ½å¼€å¯ï¼Œæˆ‘é€‰æ‹©åœ¨ back2top æŒ‰é’®ä¸Šæ˜¾ç¤ºé˜…è¯»ç™¾åˆ†æ¯”</p>
</blockquote>
<h2 id="13-å¯ç”¨æœ¬åœ°æœç´¢"><a href="#13-å¯ç”¨æœ¬åœ°æœç´¢" class="headerlink" title="13.å¯ç”¨æœ¬åœ°æœç´¢"></a>13.å¯ç”¨æœ¬åœ°æœç´¢</h2><p>åœ¨ <code>.github/workflows/pages.yml</code> ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼ˆéœ€è¦æ³¨æ„æ·»åŠ çš„ä½ç½®ï¼‰ï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/install-hexo-generator-searchdb.png"></p>
<p>ç¼–è¾‘åšå®¢æ ¹ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶ï¼Œåœ¨åº•éƒ¨æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Local Searh</span></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œå¯ç”¨æœ¬åœ°æœç´¢åŠŸèƒ½ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># If auto, trigger search by changing input.</span></span><br><span class="line">  <span class="comment"># If manual, trigger search by pressing enter key or search button.</span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span></span><br><span class="line">  <span class="comment"># Show top n results per article, show all results by setting to -1</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># Unescape html strings to the readable one.</span></span><br><span class="line">  <span class="attr">unescape:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Preload the search data when the page loads.</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h2 id="14-å¯ç”¨æ ‡ç­¾é¡µ"><a href="#14-å¯ç”¨æ ‡ç­¾é¡µ" class="headerlink" title="14.å¯ç”¨æ ‡ç­¾é¡µ"></a>14.å¯ç”¨æ ‡ç­¾é¡µ</h2><p>æ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œå¯ç”¨æ ‡ç­¾é¡µï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="comment">#about: /about/ || user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line">  <span class="comment">#categories: /categories/ || th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure>

<p>åœ¨åšå®¢æ ¹ç›®å½•çš„ source æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º tags çš„æ–‡ä»¶å¤¹ï¼Œåœ¨ tags æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª index.md æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä»£ç å—æ‰€ç¤ºï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ type çš„å€¼å¿…é¡»å†™ tagsï¼Œtitle æ˜¯æ ‡ç­¾é¡µçš„æ ‡é¢˜ï¼Œå¯ä»¥éšæ„èµ·ï¼ˆå»ºè®®ç›´æ¥åˆ æ‰ titleï¼Œæ ‡ç­¾é¡µæœ‰æ ‡é¢˜ä¸ç¾è§‚ï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: æ ‡ç­¾ </span><br><span class="line">date: 2020-01-28 17:40:00</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>ç»™æ–‡ç« æ·»åŠ æ ‡ç­¾éå¸¸ç®€å•ï¼Œä¸éœ€è¦ç”¨æˆ·å»å°†æ ‡ç­¾é¢„å…ˆåˆ›å»ºå‡ºæ¥ï¼Œåªè¦åœ¨æ–‡ç« å¼€å¤´çš„æè¿°å†…å®¹ä¸­æŒ‡å®šï¼Œç›¸å…³æ ‡ç­¾å°±ä¼šè‡ªåŠ¨ç”Ÿæˆã€‚å¦‚ä¸‹æ–¹ä»£ç å—æ‰€ç¤ºï¼Œè¿™é‡Œä¸ºæ–‡ç« æ‰“äº†ä¸¤ä¸ªæ ‡ç­¾ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hexo çš„ NexT ä¸»é¢˜ç¾åŒ–</span><br><span class="line">date: 2020-01-28 10:20:20</span><br><span class="line">updated: 2020-01-28 16:16:16</span><br><span class="line">tags: [hexo,github]</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>æ–‡ç« çš„æ ‡ç­¾è¿˜å¯ä»¥é€šè¿‡å¦ä¸€ç§æ–¹å¼æ¥æŒ‡å®šï¼Œå¦‚ä¸‹æ–¹ä»£ç æ‰€ç¤ºã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hexo çš„ NexT ä¸»é¢˜ç¾åŒ–</span><br><span class="line">date: 2020-01-28 10:20:20</span><br><span class="line">updated: 2020-01-28 16:16:16</span><br><span class="line">tags: </span><br><span class="line">  - hexo</span><br><span class="line">  - github</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h2 id="15-å¯ç”¨åˆ†ç±»é¡µ"><a href="#15-å¯ç”¨åˆ†ç±»é¡µ" class="headerlink" title="15.å¯ç”¨åˆ†ç±»é¡µ"></a>15.å¯ç”¨åˆ†ç±»é¡µ</h2><p>æ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œå¯ç”¨æ ‡ç­¾é¡µï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="comment">#about: /about/ || user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure>

<p>åœ¨åšå®¢æ ¹ç›®å½•çš„ source æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º categories çš„æ–‡ä»¶å¤¹ï¼Œåœ¨ categories æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª index.md æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä»£ç å—æ‰€ç¤ºï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ type çš„å€¼å¿…é¡»å†™ categoriesï¼Œtitle æ˜¯åˆ†ç±»é¡µçš„æ ‡é¢˜ï¼Œå¯ä»¥éšæ„èµ·ï¼ˆå»ºè®®ç›´æ¥åˆ æ‰ titleï¼Œåˆ†ç±»é¡µæœ‰æ ‡é¢˜ä¸ç¾è§‚ï¼‰ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">åˆ†ç±»</span> </span><br><span class="line"><span class="attr">date:</span> <span class="number">2020-01-28 17:40:00</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">&quot;categories&quot;</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>

<p>ä¸ä¸ºæ–‡ç« æ·»åŠ æ ‡ç­¾ç±»ä¼¼ï¼Œä¸ºæ–‡ç« æ·»åŠ æ‰€å±ç±»åˆ«ä¹Ÿåªéœ€åœ¨æ–‡ç« å¼€å¤´çš„æè¿°å†…å®¹ä¸­æŒ‡å®šï¼Œç¤ºä¾‹å¦‚ä¸‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hexo çš„ NexT ä¸»é¢˜ç¾åŒ–</span><br><span class="line">date: 2020-01-28 10:20:20</span><br><span class="line">updated: 2020-01-28 16:16:16</span><br><span class="line">categories: </span><br><span class="line">  - å¤§æ•°æ®</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>ä¸ä¸€ç¯‡æ–‡ç« å¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾ä¸åŒï¼Œä¸€ç¯‡æ–‡ç« åªèƒ½å±äºä¸€ä¸ªç±»åˆ«ï¼Œå¦‚æœåœ¨æŒ‡å®šç±»åˆ«æ—¶ï¼ŒæŒ‡å®šäº†å¤šä¸ªåˆ†ç±»ï¼Œé‚£ä¹ˆå°±ä¼šå½¢æˆå±‚çº§å…³ç³»ï¼Œå¦‚ä¸‹æ–¹ä»£ç å—æ‰€ç¤ºï¼Œè¯¥å†™æ³•è¡¨ç¤ºæ–‡ç« æ‰€å±ç±»åˆ«ä¸º a&#x2F;bã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hexo çš„ NexT ä¸»é¢˜ç¾åŒ–</span><br><span class="line">date: 2020-01-28 10:20:20</span><br><span class="line">updated: 2020-01-28 16:16:16</span><br><span class="line">categories: </span><br><span class="line">  - a</span><br><span class="line">  - b</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h2 id="16-è®¾ç½®ç½‘ç«™å›¾æ ‡"><a href="#16-è®¾ç½®ç½‘ç«™å›¾æ ‡" class="headerlink" title="16.è®¾ç½®ç½‘ç«™å›¾æ ‡"></a>16.è®¾ç½®ç½‘ç«™å›¾æ ‡</h2><p>å‡†å¤‡å¥½ä¸¤å¼ å›¾æ ‡ï¼Œå°ºå¯¸ä¸º 16x16 ä¸ 32x32ã€‚å°†ä¸‹è½½å¥½çš„å›¾æ ‡æ”¾åˆ° themes\next\source\images ç›®å½•ä¸­ï¼Œç„¶åæ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œè®¾ç½®ç½‘ç«™å›¾æ ‡ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">favicon:</span></span><br><span class="line">  <span class="attr">small:</span> <span class="string">/images/paw-16x16-next.png</span></span><br><span class="line">  <span class="attr">medium:</span> <span class="string">/images/paw-32x32-next.png</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¨èï¼šå›¾æ ‡å¯ä»¥åˆ° iconfont ä¸‹è½½</p>
</blockquote>
<h2 id="17-è®¾ç½®ä»£ç é«˜äº®ä¸»é¢˜"><a href="#17-è®¾ç½®ä»£ç é«˜äº®ä¸»é¢˜" class="headerlink" title="17.è®¾ç½®ä»£ç é«˜äº®ä¸»é¢˜"></a>17.è®¾ç½®ä»£ç é«˜äº®ä¸»é¢˜</h2><p>æ‰“å¼€ themes&#x2F;next&#x2F;_config.ymlï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">codeblock:</span></span><br><span class="line">  <span class="attr">highlight_theme:</span> <span class="string">galactic</span></span><br><span class="line">  <span class="attr">copy_button:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">show_result:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">style:</span></span><br></pre></td></tr></table></figure>

<h2 id="18-å…¬ç›Š404é¡µé¢"><a href="#18-å…¬ç›Š404é¡µé¢" class="headerlink" title="18.å…¬ç›Š404é¡µé¢"></a>18.å…¬ç›Š404é¡µé¢</h2><p>æ–°å»º 404.htmlï¼Œæ”¾åˆ°ä¸»é¢˜çš„ <code>source</code> ç›®å½•ä¸‹ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8;&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge,chrome=1&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;robots&quot;</span> <span class="attr">content</span>=<span class="string">&quot;all&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;robots&quot;</span> <span class="attr">content</span>=<span class="string">&quot;index,follow&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://qzone.qq.com/gy/404/style/404style.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/plain&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://www.qq.com/404/search_children.js&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">homePageUrl</span>=<span class="string">&quot;/blog/&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">homePageName</span>=<span class="string">&quot;å›åˆ°æˆ‘çš„ä¸»é¡µ&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://qzone.qq.com/gy/404/data.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://qzone.qq.com/gy/404/page.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="19-éšè—æ–‡ç« åº•éƒ¨-æ ‡ç­¾"><a href="#19-éšè—æ–‡ç« åº•éƒ¨-æ ‡ç­¾" class="headerlink" title="19.éšè—æ–‡ç« åº•éƒ¨#æ ‡ç­¾"></a>19.éšè—æ–‡ç« åº•éƒ¨#æ ‡ç­¾</h2><p>æ‰“å¼€ themes\next\layout_macro\post.swigï¼Œæ³¨é‡Šæ‰å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">  &#123;%- if post<span class="selector-class">.tags</span> and post<span class="selector-class">.tags</span><span class="selector-class">.length</span> %&#125;</span><br><span class="line">    &#123;%- if theme<span class="selector-class">.tag_icon</span> %&#125;</span><br><span class="line">      &#123;%- set tag_indicate = &#x27;&lt;<span class="selector-tag">i</span> class=&quot;fa fa-tag&quot;&gt;&lt;/<span class="selector-tag">i</span>&gt;&#x27; %&#125;</span><br><span class="line">    &#123;% else %&#125;</span><br><span class="line">      &#123;%- set tag_indicate = &#x27;#&#x27; %&#125;</span><br><span class="line">    &#123;%- endif %&#125;</span><br><span class="line">    &lt;<span class="selector-tag">div</span> class=&quot;post-tags&quot;&gt;</span><br><span class="line">      &#123;%- for tag in post<span class="selector-class">.tags</span><span class="selector-class">.toArray</span>() %&#125;</span><br><span class="line">        &lt;<span class="selector-tag">a</span> href=&quot;&#123;&#123; url_for(tag<span class="selector-class">.path</span>) &#125;&#125;&quot; rel=&quot;tag&quot;&gt;&#123;&#123; tag_indicate &#125;&#125; &#123;&#123; tag<span class="selector-class">.name</span> &#125;&#125;&lt;/<span class="selector-tag">a</span>&gt;</span><br><span class="line">      &#123;%- endfor %&#125;</span><br><span class="line">    &lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">  &#123;%- endif %&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<h2 id="20-å»é™¤é¡¶éƒ¨é»‘çº¿"><a href="#20-å»é™¤é¡¶éƒ¨é»‘çº¿" class="headerlink" title="20.å»é™¤é¡¶éƒ¨é»‘çº¿"></a>20.å»é™¤é¡¶éƒ¨é»‘çº¿</h2><p>æ‰“å¼€ <code>themes/next/layout/_layout.swig</code>ï¼Œæ³¨é‡Šæ‰å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt; </span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="21-å¯ç”¨å…³äºé¡µ"><a href="#21-å¯ç”¨å…³äºé¡µ" class="headerlink" title="21.å¯ç”¨å…³äºé¡µ"></a>21.å¯ç”¨å…³äºé¡µ</h2><p>æ‰“å¼€ <code>themes/next/_config.yml</code>ï¼Œå¯ç”¨å…³äºé¡µï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">home</span></span><br><span class="line">  <span class="attr">about:</span> <span class="string">/about/</span> <span class="string">||</span> <span class="string">user</span></span><br><span class="line">  <span class="attr">tags:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">tags</span></span><br><span class="line">  <span class="attr">categories:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || heartbeat</span></span><br></pre></td></tr></table></figure>

<p>åœ¨åšå®¢æ ¹ç›®å½•çš„ source æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º about çš„æ–‡ä»¶å¤¹ï¼Œåœ¨ about æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª index.md æ–‡ä»¶ï¼Œæ–‡ä»¶å¤´å¦‚ä»£ç å—æ‰€ç¤ºï¼Œå…¶ä¸­ title æ˜¯å…³äºé¡µçš„æ ‡é¢˜ï¼Œå¯ä»¥éšæ„èµ·ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">å…³äº</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-06-07 14:48:56</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>

<h2 id="22-è®¾ç½®çœ‹æ¿å¨˜"><a href="#22-è®¾ç½®çœ‹æ¿å¨˜" class="headerlink" title="22.è®¾ç½®çœ‹æ¿å¨˜"></a>22.è®¾ç½®çœ‹æ¿å¨˜</h2><p>é¦–å…ˆï¼Œæ‹‰å– <code>live2d-widget</code> é¡¹ç›®åˆ° <code>themes/next/source</code> ç›®å½•ä¸‹ï¼ˆè®°å¾—åˆ é™¤ <code>.git</code> æ–‡ä»¶å¤¹ï¼‰ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/stevenjoezhang/live2d-widget.git source/live2d-widget</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œæ‰“å¼€<code>live2d-widget</code> é¡¹ç›®ä¸­çš„ <code>autoload.js</code> æ–‡ä»¶ï¼Œä¿®æ”¹æŒ‡å®šä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä¿®æ”¹å‰</span></span><br><span class="line"><span class="keyword">const</span> live2d_path = <span class="string">&quot;https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹å</span></span><br><span class="line"><span class="keyword">const</span> live2d_path = <span class="string">&quot;/live2d-widget/&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€ï¼Œæ‰“å¼€ <code>themes/next/layout/_layout.swig</code> æ–‡ä»¶ï¼Œ åœ¨ <code>&lt;/body&gt;</code> æ ‡ç­¾ä¸Šæ–¹æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/live2d-widget/autoload.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€åï¼Œæ‰“å¼€ä¸»é¢˜é…ç½®æ–‡ä»¶ <code>themes/next/_config.yml</code> ï¼Œåœ¨å…¶ä¸­æœ«å°¾æ·»åŠ ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="23-è®¾ç½®æ ‡ç­¾äº‘"><a href="#23-è®¾ç½®æ ‡ç­¾äº‘" class="headerlink" title="23.è®¾ç½®æ ‡ç­¾äº‘"></a>23.è®¾ç½®æ ‡ç­¾äº‘</h2><p>åœ¨ <code>.github/workflows/pages.yml</code> ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼ˆéœ€è¦æ³¨æ„æ·»åŠ çš„ä½ç½®ï¼‰ï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/install-hexo-tag-cloud.png"></p>
<p>æ‰“å¼€ <code>next/layout/_macro/sidebar.swig</code>ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;% if site.tags.length &gt; 1 %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;/js/tagcloud.js&#x27;) &#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; url_for(&#x27;/js/tagcanvas.js&#x27;) &#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;widget-wrap&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ˜¾ç¤ºæ ‡é¢˜ä¸ç¾è§‚ï¼Œæ‰€ä»¥ç»™æ³¨é‡Šæ‰ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;h3 class=&quot;widget-title&quot;&gt;Tag Cloud&lt;/h3&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myCanvasContainer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;widget tagcloud&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">width</span>=<span class="string">&quot;250&quot;</span> <span class="attr">height</span>=<span class="string">&quot;250&quot;</span> <span class="attr">id</span>=<span class="string">&quot;resCanvas&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:100%&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; list_tags() &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ ä½ç½®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/hexo-tag-cloud-in-sidebar-swig.png"></p>
<p>æ‰“å¼€åšå®¢æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹è®¾ç½®ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># hexo-tag-cloud</span></span><br><span class="line"><span class="attr">tag_cloud:</span></span><br><span class="line">    <span class="attr">textFont:</span> <span class="string">&#x27;Trebuchet MS, Helvetica&#x27;</span></span><br><span class="line">    <span class="attr">textColor:</span> <span class="string">&#x27;#333&#x27;</span></span><br><span class="line">    <span class="attr">textHeight:</span> <span class="number">25</span></span><br><span class="line">    <span class="attr">outlineColor:</span> <span class="string">&#x27;#E2E1D1&#x27;</span></span><br><span class="line">    <span class="attr">maxSpeed:</span> <span class="number">0.1</span> <span class="comment"># range from [0.01 ~ 1]</span></span><br><span class="line">    <span class="attr">pauseOnSelected:</span> <span class="literal">false</span> <span class="comment"># true means pause the cloud tag movement when highlight a tag</span></span><br></pre></td></tr></table></figure>

<h2 id="24-å‚è€ƒèµ„æº"><a href="#24-å‚è€ƒèµ„æº" class="headerlink" title="24.å‚è€ƒèµ„æº"></a>24.å‚è€ƒèµ„æº</h2><ul>
<li><a href="https://theme-next.org/">ä¸»é¢˜å®˜ç½‘-æ–°</a></li>
<li><a href="http://theme-next.iissnan.com/">ä¸»é¢˜å®˜ç½‘-æ—§</a></li>
<li><a href="https://www.bilibili.com/video/av17653359">ä½¿ç”¨Hexoåšå®¢æ­å»ºçš„ä¸ªäººåšå®¢ï¼Œä½¿ç”¨Nextä¸»é¢˜æ¥è¿›è¡Œä¼˜åŒ–æ”¹é€ </a></li>
<li><a href="https://www.jianshu.com/p/9f0e90cc32c2">Hexo-NexTé…ç½®è¶…ç‚«ç½‘é¡µæ•ˆæœ</a></li>
<li><a href="https://blog.csdn.net/lcyaiym/article/details/76768762?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1-76768762-blog-61414438.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1-76768762-blog-61414438.pc_relevant_default&utm_relevant_index=1">hexoçš„nextåˆ›å»ºå…³äºæˆ‘</a></li>
<li><a href="https://blog.51cto.com/u_13640625/3032364">Nextä¸»é¢˜ä¸­æ·»åŠ è¶…çº§å¥½ç©çš„çœ‹æ¿å¨˜ï¼ˆCDNæ–¹å¼ï¼‰</a></li>
<li><a href="https://www.ngui.cc/51cto/show-540008.html">Hexoåšå®¢+Nextä¸»é¢˜æ·±åº¦ä¼˜åŒ–ä¸å®šåˆ¶</a></li>
<li><a href="https://github.com/stevenjoezhang/live2d-widget">stevenjoezhang&#x2F;live2d-widget: æŠŠèŒèŒå“’çš„çœ‹æ¿å¨˜æŠ±å›å®¶ (ãƒâ‰§âˆ‡â‰¦)ãƒ</a></li>
<li><a href="https://cloud.tencent.com/developer/article/1934183">Hexoåšå®¢å»ºç«‹æ ‡ç­¾äº‘åŠæ•ˆæœå±•ç¤º</a></li>
<li><a href="https://github.com/D0n9X1n/hexo-tag-cloud">D0n9X1n&#x2F;hexo-tag-cloud: Yet, just another tag cloud plugin for hexo</a></li>
</ul>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>åŸºäº Github + PicGo æ­å»ºä¸ªäººå›¾åºŠ</title>
    <url>/2022/06/06/other/%E5%9F%BA%E4%BA%8E%20Github%20+%20PicGo%20%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%9B%BE%E5%BA%8A/</url>
    <content><![CDATA[<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/panda-banner-1.png"></p>
<span id="more"></span>

<h2 id="01-ç”Ÿæˆ-Github-ç§äººä»¤ç‰Œ"><a href="#01-ç”Ÿæˆ-Github-ç§äººä»¤ç‰Œ" class="headerlink" title="01.ç”Ÿæˆ Github ç§äººä»¤ç‰Œ"></a>01.ç”Ÿæˆ Github ç§äººä»¤ç‰Œ</h2><p>é€šè¿‡<a href="https://github.com/settings/tokens">é“¾æ¥</a>è¿›å…¥ <code>Github</code> çš„ <code>tokens</code> é¡µé¢ï¼Œç‚¹å‡»é¡µé¢å³ä¸Šæ–¹çš„ <code>Generate new token</code> æŒ‰é’®åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>token</code>ï¼Œè®°ä¸‹è¿™ä¸ª <code>token</code>ï¼Œåé¢ä¼šä½¿ç”¨åˆ°ã€‚</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/github-token.png"></p>
<h2 id="02-é…ç½®-Github-å›¾åºŠ"><a href="#02-é…ç½®-Github-å›¾åºŠ" class="headerlink" title="02.é…ç½® Github å›¾åºŠ"></a>02.é…ç½® Github å›¾åºŠ</h2><p>ä¸‹è½½å®‰è£… <a href="https://github.com/Molunerfinn/PicGo/releases">PicGo</a>ï¼Œé…ç½® Github å›¾åºŠï¼Œé…ç½®ç»†èŠ‚å¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/pocgo-github.png"></p>
<h2 id="03-ä¸Šä¼ å›¾ç‰‡åˆ°-Github-å›¾åºŠ"><a href="#03-ä¸Šä¼ å›¾ç‰‡åˆ°-Github-å›¾åºŠ" class="headerlink" title="03.ä¸Šä¼ å›¾ç‰‡åˆ° Github å›¾åºŠ"></a>03.ä¸Šä¼ å›¾ç‰‡åˆ° Github å›¾åºŠ</h2><p>ä¸Šä¼ å›¾ç‰‡åï¼Œè¿”å›çš„é“¾æ¥ä¼šè‡ªåŠ¨è¿›å…¥å‰ªè´´æ¿ï¼Œå¯ç›´æ¥ç²˜è´´ä½¿ç”¨ã€‚</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/pocgo-github-1.png"></p>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title>åŸºäº Hexo + Github Pages + Github Actions æ­å»ºä¸ªäººåšå®¢</title>
    <url>/2022/06/06/other/%E5%9F%BA%E4%BA%8E%20Hexo%20+%20Github%20Pages%20+%20Github%20Actions%20%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/panda-banner-1.png"></p>
<span id="more"></span>

<h2 id="01-åˆå§‹åŒ–ä»“åº“"><a href="#01-åˆå§‹åŒ–ä»“åº“" class="headerlink" title="01.åˆå§‹åŒ–ä»“åº“"></a>01.åˆå§‹åŒ–ä»“åº“</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br><span class="line">hexo init zhoulii.github.io</span><br><span class="line">cd zhoulii.github.io</span><br><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;initialize zhoulii.github.io&quot;</span><br><span class="line">git remote add origin https://github.com/zhoulii/zhoulii.github.io.git</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<h2 id="02-é…ç½®-Github-Actions"><a href="#02-é…ç½®-Github-Actions" class="headerlink" title="02.é…ç½® Github Actions"></a>02.é…ç½® Github Actions</h2><p>åœ¨ä»“åº“ä¸­åˆ›å»º <code>.github/workflows/pages.yml</code>ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">name: deploy zhoulii.github.io  </span><br><span class="line">  </span><br><span class="line">on:  </span><br><span class="line">  push:  </span><br><span class="line">    branches:  </span><br><span class="line">      - master</span><br><span class="line">  </span><br><span class="line">jobs:  </span><br><span class="line">  pages:  </span><br><span class="line">    runs-on: ubuntu-latest  </span><br><span class="line">    steps:  </span><br><span class="line">      - uses: actions/checkout@v2  </span><br><span class="line">      - name: Use Node.js 16.x  </span><br><span class="line">        uses: actions/setup-node@v2  </span><br><span class="line">        with:  </span><br><span class="line">          node-version: &#x27;16&#x27;  </span><br><span class="line">      - name: Cache NPM dependencies  </span><br><span class="line">        uses: actions/cache@v2  </span><br><span class="line">        with:  </span><br><span class="line">          path: node_modules  </span><br><span class="line">          key: $&#123;&#123; runner.OS &#125;&#125;-npm-cache  </span><br><span class="line">          restore-keys: |  </span><br><span class="line">            $&#123;&#123; runner.OS &#125;&#125;-npm-cache  </span><br><span class="line">      - name: Install Dependencies  </span><br><span class="line">        run: npm install  </span><br><span class="line">      - name: Build  </span><br><span class="line">        run: npm run build  </span><br><span class="line">      - name: Deploy  </span><br><span class="line">        uses: peaceiris/actions-gh-pages@v3  </span><br><span class="line">        with:  </span><br><span class="line">          github_token: $&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;  </span><br><span class="line">          publish_dir: ./public</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š</p>
<ul>
<li><code>node</code> ç‰ˆæœ¬éœ€è¦ä¸æœ¬åœ°æœºå™¨ä¸€è‡´ï¼ˆå¯ä½¿ç”¨ <code>node --version</code> æŸ¥çœ‹ï¼‰</li>
<li>é…ç½®ä¸­çš„å˜é‡ä¸éœ€è¦æ‰‹åŠ¨æŒ‡å®š</li>
</ul>
<p>å°† <code>.github/workflows/pages.yml</code> åŒæ­¥åˆ°è¿œç¨‹ä»“åº“ï¼Œç‚¹å‡»ä»“åº“ä¸»é¡µçš„ <code>Actions</code> æ ‡ç­¾ï¼Œå¯ä»¥çœ‹åˆ° <code>workflow</code> çš„æ‰§è¡Œæƒ…å†µã€‚</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/github-actions-hexo.png"></p>
<p><code>workflow</code> æ‰§è¡Œå®Œæˆåï¼Œä»“åº“ä¼šå¤šå‡ºä¸€ä¸ªåä¸º <code>gh-pages</code> çš„åˆ†æ”¯ï¼Œ<code>Hexo</code> ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶å³åœ¨è¯¥åˆ†æ”¯ä¸‹ã€‚</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/gh-pages-branch.png"></p>
<h2 id="03-é…ç½®-Github-Pages"><a href="#03-é…ç½®-Github-Pages" class="headerlink" title="03.é…ç½® Github Pages"></a>03.é…ç½® Github Pages</h2><p><code>Hexo</code> ç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶åœ¨  <code>gh-pages</code>  åˆ†æ”¯ä¸‹ï¼Œæ¥ä¸‹æ¥é…ç½® <code>Github Pages</code> ä» <code>gh-pages</code>  åˆ†æ”¯æ„å»ºç«™ç‚¹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/github-pages-hexo.png"></p>
<p>é…ç½®å®Œæˆåï¼Œç¨ç­‰ä¸ªä¸€ä¸¤åˆ†é’Ÿï¼Œç½‘ç«™å°±å¯ä»¥è®¿é—®äº†ï¼Œç½‘ç«™é¦–é¡µå¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/zhoulii/figure-bed/main/fig/hello-world-hexo.png"></p>
<h2 id="04-å‚è€ƒèµ„æ–™"><a href="#04-å‚è€ƒèµ„æ–™" class="headerlink" title="04.å‚è€ƒèµ„æ–™"></a>04.å‚è€ƒèµ„æ–™</h2><ul>
<li><a href="https://hexo.io/docs/github-pages.html">GitHub Pages | Hexo</a></li>
<li><a href="https://github.com/peaceiris/actions-gh-pages">peaceiris&#x2F;actions-gh-pages: GitHub Actions for GitHub Pages</a></li>
<li><a href="https://www.jianshu.com/p/eadeddb792c5">åšå®¢ä¹‹æ—…ï¼šä» Jekyll åˆ° Hexo</a></li>
</ul>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>github</tag>
      </tags>
  </entry>
</search>
